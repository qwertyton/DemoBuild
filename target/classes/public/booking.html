
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style1.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <link rel="stylesheet" href="user.css">
</head>

<style>
     .reservation {
        font-family: 'Arial', sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
        display: grid;
        
        height: 100%;
    }

    .content {
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
        max-width: 100%;
        width: 100%;
    }

    h1 {
        color: #333;
    }

    p {
        color: #666;
    }

    label {
        display: block;
        margin-bottom: 5px;
        color: #333;
    }

    input,
    select {
        width: 100%;
        padding: 8px;
        margin-bottom: 10px;
        box-sizing: border-box;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    button {
        background-color: #FF6F31;
        color: white;
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px 0px;
    }

    button:hover {
        background-color: #FF6F31;

    }

    #reservationResult {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #ddd;
    }
</style>

<body>

    <div class="grid">
        <div class="sidebar con">
            <div class="logo">
                <a href="">
                    <img src="../homepage/photo/logo.png" alt="">
                </a>
            </div>
           
            <div class="main-content">
                <div class="name">
                    <h3><span id="usernamePlaceholder"></span></h3>
                </div>
                    <!-- ข้อมูลของผู้ใช้จะแสดงที่นี่ -->
                    <div class="logout">
                        <p><a href="#" onclick="logout()" style="color: red;">Logout</a></p>
                    </div>
                
            </div>
    
            
    <script>
        // ตรวจสอบว่ามีข้อมูลผู้ใช้ที่เข้าสู่ระบบมาหรือไม่
        const username = localStorage.getItem('username');
        const userId = localStorage.getItem('userId');

        if (username && userId) {
            // แสดงข้อมูลผู้ใช้ที่เข้าสู่ระบบมา
            document.getElementById('usernamePlaceholder').innerText = username;
        } else {
            // ไม่มีข้อมูลผู้ใช้, สามารถทำการ redirect หรือจัดการตามต้องการ
            window.location = "login.html";
        }

        // เพิ่มฟังก์ชัน logout
        function logout() {
            localStorage.removeItem('username');
            localStorage.removeItem('userId');
            window.location = "/";
        }
    </script>

            <ul>
                <li>
                    <a href="home.html">
                        <i class="bi bi-geo-alt-fill"></i>
                        <span>View map</span>
                    </a>
                </li>
                <li>
                    <a href="Bookinghistory.html">
                        <i class="bi bi-calendar2-week-fill"></i>
                        <span>Booking History</span>
                    </a>
                </li>
                <li>
                    <a href="station.html">
                        <i class="bi bi-ev-station"></i>
                        <span>Station</span>
                    </a>
                </li>
               
                 
            </ul>

        </div>
        <div class="navbar con">

            <div class="map">
                <span><a href="#">Map</a></span>
            </div>

            <div class="station">
                <span><a href="station.html">Booking</a></span>
            </div>

            <div class="searchcontainer">

                <div id="search-wrapper">

                    <input type="text" id="search" placeholder="Place,Postcode">
                    <button id="search-button"><a href=""><i class="search-icon fas fa-search"></i></a></button>

                </div>
            </div>

        </div>


     
            
            <div class="content con">
                <div class="reservation">
                    <h1>Charging Reservation</h1>
                    <p>Please fill in the details to make a reservation:</p>
                    <form id="bookingForm">
                        <label for="userId">Name:</label>
                        <input type="text" id="userId" name="userId" required>
                        
                        <br>
        
                        <label for="license">License:</label>
                        <input type="text" id="license" name="license" required>
                        
                        <br>
        
                        <label for="fieldOne">Select Time:</label>
                        <select id="fieldOne" name="fieldOne">
                            <option value="06.30-06.57">06.30-06.57</option>
                            <option value="07.00-07.27">07.00-07.27</option>
                            <option value="07.30-08.27">07.30-08.27</option>
                            <!-- Add more options for other time slots -->
                        </select>
                        <br>
        
                        <label for="fieldTwo">Select Station:</label>
                        <select id="fieldTwo" name="fieldTwo">
                            <option value="EVolt Charging Station">EVolt Charging Station</option>
                            <option value="PTT Station ปตท.มหาวิทยาลัยแม่ฟ้าหลวง">PTT Station ปตท.มหาวิทยาลัยแม่ฟ้าหลวง</option>
                            <option value="ปั๊มเอสโซ่ หจก.ภาณุออยล์ เซอร์วิส">ปั๊มเอสโซ่ หจก.ภาณุออยล์ เซอร์วิส</option>
                            <option value="PTT Station ปตท.ห้าแยกพ่อขุน สถานีบริการน้ำมัน + NGV + EV เคยูออยล์">PTT Station ปตท.ห้าแยกพ่อขุน สถานีบริการน้ำมัน + NGV + EV เคยูออยล์</option>
                            <option value="PTT Station ปตท.ริมกก (น้ำมัน+EV) หจก.ปัญญามอเตอร์ส">PTT Station ปตท.ริมกก (น้ำมัน+EV) หจก.ปัญญามอเตอร์ส</option>
                            <option value="PTT Station ปตท.เวียงป่าเป้า (น้ำมัน+EV) (เชียงรายกิตติรัตน์ สาขาเวียงป่าเป้า)">PTT Station ปตท.เวียงป่าเป้า (น้ำมัน+EV) (เชียงรายกิตติรัตน์ สาขาเวียงป่าเป้า)ส</option>
                            <option value="PTT Station ปตท. ถนนบายพาสวงแหวนตะวันออกเชียงราย (น้ำมัน+EV)">PTT Station ปตท. ถนนบายพาสวงแหวนตะวันออกเชียงราย (น้ำมัน+EV)</option>
                            <option value="PTT Station ปตท.แม่ขะจาน (น้ำมัน+EV) หจก.เชียงรายกิตติรัตน์">PTT Station ปตท.แม่ขะจาน (น้ำมัน+EV) หจก.เชียงรายกิตติรัตน์</option>
                            <option value="เซ็นทรัล เชียงราย">เซ็นทรัล เชียงราย</option>
                            <!-- Add more options for other time slots -->
                        </select>
                        <br>
                        
                        <button type="button" onclick="makeReservation()">Booking</button>
                    </form>
        
                    
                    <div id="reservationResult"></div>
                </div>
            </div>
        
            <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
            <script>
                function makeReservation() {
                    const userId = $('#userId').val();
                    const fieldOne = $('#fieldOne').val();
                    const fieldTwo = $('#fieldTwo').val();
        
                    const data = {
                        name : userId,
                        fieldOne: fieldOne,
                        fieldTwo : fieldTwo,
                        fieldFive : fieldTwo,
                        fieldThree : $('#license').val()
                    };
        
                    $.ajax({
                        type: 'POST',
                        url: 'http://localhost:8100/booking',
                        contentType: 'application/json; charset=UTF-8',
                        data: JSON.stringify(data),
                        success: function (response) {
                            console.log(response);
                            if (response != ""){
                                alert('Booking successful!');
                                
                            } else {
                                alert('Slot time is full, Please Booking again.');
                            }
                        },
                        error: function (xhr, status, error) {
                            console.error('Error:', xhr.status, error);
                            alert('Booking failed. Please try again.');
                        }
                    });
                }
        
                function displayReservationResult(result) {
                    $('#reservationResult').html('<h2>Reservation Result</h2>');
                    for (const reservation of result) {
                        $('#reservationResult').append(`
                            <p>User ID: ${reservation.userId}</p>
                            <p>Selected Time: ${reservation.fieldOne}</p>
                            <!-- Add more fields as needed -->
                            <hr>
                        `);
                    }
                }
            </script>

                            
        </div>
    </div>

</body>

</html>